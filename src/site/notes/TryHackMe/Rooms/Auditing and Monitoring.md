---
{"dg-publish":true,"permalink":"/try-hack-me/rooms/auditing-and-monitoring/","created":"2025-02-20T19:07:33.496-05:00","updated":"2025-02-20T22:48:50.488-05:00"}
---

# Task 2 - Audit Objectives and Types

- Auditing of information systems involves the systematic, independent, and objective examination of an organization’s IT infrastructure, processes, and controls.
- The objectives of an information systems audit are to evaluate the **effectiveness, security, and compliance** of systems and data management within an organization.
- **Audit Objectives**
	- **Assess the effectiveness of internal controls** 
		- Mitigates the risk of fraud, errors, and other disruptions to the organization’s operations.
	- **Identify and assess risks** 
		- Help develop and implement appropriate controls to mitigate risks to the organization’s information systems.
	- **Assess the efficiency and effectiveness of information systems** 
		- Help improve the performance of its information systems and make better decisions about future investments in information technology.
	- **Ensure compliance with laws and regulations** 
		- Protects the organization from fines, penalties, and other legal sanctions.
- **Audit Types**
	- **Internal audits** 
		- Performed by an organization’s personnel or staff members assigned to the internal audit function.
	- **External audits** 
		- Conducted by independent auditors not employed by the organization being audited. 
		- Typically from external accounting or auditing firms
			- Primary purpose is to provide an impartial and objective review.
	- **Third-party audits**
		- Conducted when an organization needs to assess its IT systems or controls within third parties, such as vendors, service providers, or subcontractors. 
			- Ensure that the external entities a company relies on adhere to the required security, data protection, and compliance standards
			- Minimizes potential risks and exposures that may arise from their operations.

> [!Question]
>  **Which type of audit is conducted by independent auditors?**

> [!Success] Answer
> External Audit

> [!Question]
>  **Which type of audit is conducted by an organisation’s own personnel?**

> [!Success] Answer
> Internal Audit

# Task 3 - Audit Frameworks

Structured approach comprising principles, concepts, and practices used to conduct an audit. It provides guidelines on planning, executing, and reporting on an audit effectively and ensures that audits are objective and consistent. Provides efficiency, value, and transparency to the audit process.

- **COSO** 
	- Private-sector initiative that develops frameworks for enterprise risk management, internal control, and fraud deterrence. 
	- Most widely used frameworks for auditing internal controls.
- **COBIT** 
	- Provides a comprehensive set of control objectives that can be used to assess the effectiveness of an organization’s IT governance and management practices. 
- **ISAE 3402** 
	- International standard that provides guidance on the assurance of controls over financial reporting. 
	- Auditors use it to assure of the effectiveness of an organization’s internal controls over financial reporting.
- **ISO 27001:** 
	- International standard for providing a set of best practices for information security management. 
- **ITIL** 
	- Framework of best practices for IT Service Management (ITSM). 
	- ITIL is used in auditing to establish a systematic approach for assessing an organization’s management and governance of IT services. 
- **PCI DSS** 
	- Set of security requirements for organizations that accept payment cards. 
	- Designed to protect cardholder data from unauthorized access, use, disclosure, alteration, or destruction. 
- **SOX** 
	- Federal law that establishes auditing and financial reporting requirements for public companies. 
	- Designed to protect investors by improving the accuracy and reliability of financial reporting. 

|Framework|Description|Industries|Notes|
|---|---|---|---|
|COSO|Internal control framework that helps organisations design, implement, and monitor their internal controls.|All industries|COSO is a comprehensive framework that covers all aspects of internal control.|
|COBIT|IT governance framework that helps organisations align their IT with their business goals.|All industries|COBIT is a flexible framework that can be adapted to the needs of any organisation.|
|ISAE 3402|Assurance standard that provides assurance on the controls of a service organisation.|All industries|ISAE 3402 is a relatively new standard gaining popularity in the financial services industry.|
|ISO 27001|Information security management system (ISMS) standard that helps organisations protect their information assets.|All industries|ISO 27001 is the world’s most widely adopted ISMS standard.|
|ITIL|IT service management (ITSM) framework that helps organisations deliver high-quality IT services.|All industries|ITIL is a well-established framework that organisations of all sizes use.|
|PCI DSS|Payment Card Industry Data Security Standard that helps organisations protect cardholder data.|Financial services|PCI DSS is a mandatory standard for organisations that process credit and debit card payments.|
|SOX|Sarbanes-Oxley Act that sets requirements for internal controls over financial reporting.|Publicly traded companies|SOX is a complex law that has a significant impact on public companies.|

> [!Question]
>  **What is the standard used by organisations that process card payments?**

> [!Success] Answer
> PCI DSS

> [!Question]
>  **Who developed ITIL?**

Searched up

> [!Success] Answer
> CCTA

> [!Question]
>  **Who developed COBIT?**

Searched up

> [!Success] Answer
> ISACA

# Task 4 - Auditing IT Infrastructure and Operations

- **Planning** 
	- Determine the audit’s scope, objectives, and timelines. 
	- Understanding the organization’s IT environment 
		- Includes infrastructure, systems, applications, security measures, and data management practices
		- Identifying potential risks and controls to be evaluated.
- **Information gathering** 
	- Collecting relevant data, background information, and documentation to thoroughly understand the organization’s IT processes and systems. 
	- Involves interviewing key personnel, reviewing resource documentation, analyzing procedures and policies, and examining the control environment.
- **Risk assessment and control evaluation** 
	- Identifies and assesses the risks and vulnerabilities within the organization’s IT infrastructure, processes, and systems. 
	- Evaluating the effectiveness of internal controls, security measures, and compliance with applicable policies, regulations, and industry standards.
- **Testing** 
	- Detailed tests on selected systems, applications, specific processes or control procedures to validate their effectiveness, accuracy, and compliance. 
		- Data analysis, vulnerability scanning, penetration testing, controls testing, or sampling, depending on the audit objectives and the audited systems.
- **Analysis and findings** 
	- Analyzes the testing and evaluation results, identifies deviations, irregularities, or vulnerabilities, and evaluates the implications. 
	- Determine if systems are configured securely, IT processes are effective and compliant, or risks are adequately mitigated.
- **Reporting** 
	- Documents the findings and conclusions, makes recommendations for improvement where necessary, and prepares a formal audit report. 
	- Shared with the management, the audit committee, or other stakeholders as required
- **Follow-up** 
	- Evaluate if the recommended improvements and corrective actions have been implemented and ensure their effectiveness in addressing the identified issues.
- **Audit Scenario**
	- Let’s say that we are auditing a company using COBIT. We might go through a series of steps that resemble the following:
	- **Step 1: Planning**
		- **Define the scope of the audit** 
			- Defining the scope of the audit
			- Identify relevant COBIT domains that apply to the organization’s IT governance practices.
		- **Identify relevant COBIT controls** 
			- Find appropriate COBIT controls that are in place to mitigate the risks identified in the scope of the audit.
		- **Develop an audit plan** 
			- Develop an audit plan that outlines the steps that will be taken to gather evidence
			- Assess the organization’s compliance with the relevant COBIT controls.
	- **Step 2: Execution**
		- **Gather evidence** 
			- Gathering evidence of the organization’s compliance with the relevant COBIT controls. 
			- Documentation, interviews, and observations.
		- **Assess the evidence** 
			- Assess the evidence to determine compliance relevant COBIT controls.
	- **Step 3: Assessment**
		- **Identify gaps in compliance:** 
			- Identify gaps in the organization’s compliance with the relevant COBIT controls.
		- **Make recommendations for improvement** 
			- Make recommendations for improvement to the organization’s IT governance practices.
	- **Step 4: Reporting**
		- **Prepare the audit report** 
			- Summarize the audit findings and making recommendations for improvement.
		- **Communicate the audit report**
			- Communicate it to the organization’s management and stakeholders.
	- **Step 5: Follow-up**
		- **Monitor the implementation of recommendations** 
			- Ensure that the organization is taking steps to improve its IT governance practices.


> [!Question]
>  **Which step do we present our findings about non-conformities, weaknesses and issues noted?**

> [!Success] Answer
> 4

> [!Question]
>  **At which stage does an organisation review the steps based on recommendations for proper and satisfactory implementation?**

> [!Success] Answer
> 5

> [!Question]
>  **At which stage do the auditors establish the audit scope and define its objectives?**

> [!Success] Answer
> 1

# Task 5 - Logs

- Process of recording events as they take place on systems.
	- Problems and errors
	- Information about current operations
- Purpose
	- Troubleshooting, monitoring, auditing, compliance
# Task 6 - Log Management on Linux

- Most logs files are stored in directories inside `/var/log`
- System logging daemons
	- `rsyslog`, `syslog-ng`,`journald`
	- Manages, process, and store log events.
- **Log types**
	- System logs
	- Application logs 
	- Security logs
- **Managing logs**
	- Log to a central location
	- Use a tool to filter and parse the logs
	- Setup alerts
- **aureport**
	- Linux command-line tool used to audit linux system logs
	- Example command for aureport
		- `aureport --failed`
			- `--summary`
				- Gets summary of event
			- `--failed`
				- Gets failed events
	- Example command for ausearch
		- `ausearch --message USER_LOGIN --success yes --interpret`
			- `--message`
				- Followed by the message we are interested in searching for. Examples include `USER_LOGIN`, `DEL_USER`, `ADD_GROUP`, `USER_CHAUTHTOK`, `DEL_GROUP`, `CHGRP_ID`, `ROLE_ASSIGN`, and `ROLE_REMOVE`.
			- `--success` 
				- is followed by `yes` or `no`
			- `--interpret` 
				- converts numeric entities, such as UID (User ID), into text.


> [!Question]
>  **Using `aureport`, how many failed logins have occurred so far?**

![](/img/user/TryHackMe/THM_Images/Pasted image 20250220222228.png)

> [!Success] Answer
> 1

> [!Question]
>  **Using `ausearch`, how many failed logins are related to the username `mike`?**

![](/img/user/TryHackMe/THM_Images/Pasted image 20250220222430.png)

> [!Success] Answer
> 4

> [!Question]
>  **Using `ausearch`, how many failed logins are related to the username `root`?**

![](/img/user/TryHackMe/THM_Images/Pasted image 20250220222625.png)

> [!Success] Answer
> 227

# Task 7 - Log Management on MS Windows

- Windows logs, also event logs, Four primary types include:
	- **System Logs**: 
		- Activity with  system components, such as driver failure, resource conflict, and hardware issues. 
	- **Application Logs**: 
		- This type concerns individual software living upon the system. 
		- Failing to connect to a database or process-related bottlenecks
	- **Security Logs**: 
		- Specialized logs designed to track security events. 
		- Events such as logon and logoff actions, user rights assignments, policy changes, and security-related aberrations.
	- **Forwarded Events Logs**:  
		- Collated reports, pulling from multiple sources into a centralized file. 
		- Ideal for monitoring tasks and analysis in a networked environment
			- May need to assemble data from various places into a cohesive analysis.

|Feature|Linux Logs|Windows Logs|
|---|---|---|
|Location|`/var/log`|`%SystemRoot%\System32\Logfiles`|
|Format|Syslog|EventLog|
|Logging levels|Debug, Info, Notice, Warning, Error, Critical|Debug, Information, Warning, Error, Critical|
|Tools for viewing logs|`tail`, `grep`, `less`|Event Viewer|
|Advantages|More flexible, easier to parse|More user-friendly, more integrated with Windows|
|Disadvantages|Can be less intuitive, less centralized|Can be more difficult to troubleshoot|

Example logon event IDs that can be used with windows event viewer

| Logon events | Description                                                    |
| ------------ | -------------------------------------------------------------- |
| 4624         | A user successfully logged on to a computer.                   |
| 4625         | Logon failed due to an unknown username or a wrong password.   |
| 4634         | The logoff process was completed.                              |
| 4647         | A user started the logoff process.                             |
| 4779         | A user disconnected from a remote session without logging off. |


> [!Question]
>  **What is the event ID for a failed login attempt?**

> [!Success] Answer
> 4625

> [!Question]
>  **How many failed login attempts do you have under the security events?**

Went to "Windows Logs" and then "Security Logs"

![](/img/user/TryHackMe/THM_Images/Pasted image 20250220223626.png)

Clicked on "Filter Current Log" on the right

![](/img/user/TryHackMe/THM_Images/Pasted image 20250220223835.png)

Filled out with log id "4625" to filter for failed login attempts

![](/img/user/TryHackMe/THM_Images/Pasted image 20250220223750.png)

![](/img/user/TryHackMe/THM_Images/Pasted image 20250220223904.png)

> [!Success] Answer
> 2

> [!Question]
>  **How many failed login attempts took place in 2021?**

![](/img/user/TryHackMe/THM_Images/Pasted image 20250220224047.png)

![](/img/user/TryHackMe/THM_Images/Pasted image 20250220224118.png)

> [!Success] Answer
> 1

# Task 8 - Monitoring

- While both involve in-depth analysis of system behaviours,  logging and monitoring are not the same. 
	- Logging provides a historical account of events for later analysis or audit review
		- Essential for diagnostic, forensics, and compliance purposes. 
	- Monitoring is a real-time, continuous process used to detect issues or anomalies immediately
		- Ensures effective operational control, security, and optimal performance.

|                                               | Logging                                                                         | Monitoring                                                                                                        |
| --------------------------------------------- | ------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------- |
| **Primary Function**                          | To record system activities for later review                                    | To deliver real-time observation of system status                                                                 |
| **Error Detection**                           | After it hits, provides a data trail to backtrack the issue                     | Identify and notify irregularities as they occur                                                                  |
| **Process**                                   | A constant, passive process recording activities and system changes             | An active, ongoing process receiving alerts or warnings based on predefined triggers                              |
| **Typical Uses**                              | Error diagnostics post-issue, compliance proof, audit trails, forensic analysis | Daily operational tracking, preventative maintenance, bottlenecks detection, real-time functionality and security |
| **Timeliness of Notification and Inspection** | Used primarily for retrospective analysis of problems                           | Real-time reporting of potential issues                                                                           |
| **Key Objectives**                            | Error diagnosis, accountability and providing detailed context                  | Eradicate small issues from escalating and becoming larger problem                                                |

# Task 10 - Comparison between logging, monitoring, and auditing

|                           | Logging                                                                | Monitoring                                                               | Auditing                                                                                   |
| ------------------------- | ---------------------------------------------------------------------- | ------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------ |
| **Definition**            | Recording of system activities and changes                             | Real-time data and report collection to observe system status            | Systematic analysis and review of actions within the systems                               |
| **Main function**         | Stores a historical account of system processes, activities, or events | Records and visualises the live state of systems                         | Checks compliance with set IT standards and corrective actions                             |
| **Result identification** | Often post-issue or upon check                                         | Real-time, at the time of anomaly or breach                              | Usually post-action, during compliance checks                                              |
| **Process flow**          | Operates passively to collect data as events transpire                 | Active process analysing and inspecting system performance regularly     | Performed at set times, often periodic, can be triggered by events                         |
| **Uses**                  | Find faults, debug, forensics, assists in audits                       | Maintain system performance, real-time fault-tracking, foreseeing issues | Validate regularity, safety inspection, prove accountability and lessening potential risks |
| **Key Role**              | Data gathering and accountability                                      | Preventive and predictive maintenance                                    | Compliance, verification, and legal professionalism                                        |
